dev1 code modified by TL